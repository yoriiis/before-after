/**
 * @license MIT
 * @name BeforeAfter
 * @version 2.0.2
 * @author: Yoriiis aka Joris DANIEL <joris.daniel@gmail.com>
 * @description: BeforeAfter is a lightweight Javascript library to compare images in before/after view without any dependencies
 * {@link https://github.com/yoriiis/before-after.js}
 * @copyright 2019 Joris DANIEL
 **/

"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var BeforeAfter=function(){function t(e){_classCallCheck(this,t);var i=e||{};this.options=Object.assign({element:null,cursor:!0,direction:"ltr",selectors:{item:".beforeafter-item",itemActive:".beforeafter-itemActive",cursor:".beforeafter-cursor",imageWrapper:".beforeafter-wrapperImage"}},i),this.hasTouch="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,this.hasMSPointer=window.navigator.msPointerEnabled,null===this.options.element&&console.warn("BeforeAfter::Option element is missing"),this.itemActive=this.options.element.querySelector(this.options.selectors.itemActive),this.orientation="",this.attrToAnimate="",this.widthHeight="",this.heightElement=null,this.widthElement=null,this.timerGoTo=null,this.timerGoToAfter=null,this.timerCleaned=!1,this.cursor=null}return _createClass(t,[{key:"create",value:function(t){var e=this;null===this.itemActive?console.warn("BeforeAfter::Item active is missing"):(this.detectOrientation(),this.itemActive.style.zIndex=1,this.options.cursor&&this.updateCursor(),this.checkImagesLoaded(function(){e.heightElement=parseInt(e.options.element.offsetHeight),e.widthElement=parseInt(e.options.element.offsetWidth),e.addImageWrapper()}),this.addEvents(),"function"==typeof t&&t())}},{key:"detectOrientation",value:function(){"ltr"===this.options.direction||"rtl"===this.options.direction?(this.orientation="horizontal",this.widthHeight="width",this.attrToAnimate="ltr"===this.options.direction?"left":"right"):"ttb"!==this.options.direction&&"btt"!==this.options.direction||(this.orientation="vertical",this.attrToAnimate="ttb"===this.options.direction?"top":"bottom",this.widthHeight="height")}},{key:"buildCursor",value:function(){var t="<div class='".concat(this.options.selectors.cursor.substr(1),"'></div>");this.options.element.insertAdjacentHTML("beforeend",t)}},{key:"updateCursor",value:function(){null===this.cursor&&this.buildCursor(),this.cursor=this.options.element.parentNode.querySelector(this.options.selectors.cursor),this.cursor.style.position="absolute",this.cursor.style.zIndex=10,this.cursor.style.backgroundColor="#000",this.cursor.style.overflow="hidden",this.cursor.style.display="block","horizontal"===this.orientation?(this.cursor.style.width="2px",this.cursor.style.height="100%",this.cursor.style.top="0px"):"vertical"===this.orientation&&(this.cursor.style.width="100%",this.cursor.style.height="2px",this.cursor.style.left="0px"),"ltr"===this.options.direction&&(this.cursor.style.left="0px"),"rtl"===this.options.direction&&(this.cursor.style.left="auto",this.cursor.style.right="0px"),"ttb"===this.options.direction&&(this.cursor.style.top="0px"),"btt"===this.options.direction&&(this.cursor.style.top="auto",this.cursor.style.bottom="0px")}},{key:"checkImagesLoaded",value:function(t){var e=_toConsumableArray(this.options.element.querySelectorAll("img")),i=0;e.forEach(function(o){var s=new Image;s.src=o.getAttribute("src"),s.onload=function(){++i===e.length-1&&t()}})}},{key:"addImageWrapper",value:function(){var t=this;_toConsumableArray(this.options.element.querySelectorAll("img")).forEach(function(e){var i=document.createElement("div");i.classList.add(t.options.selectors.imageWrapper.substr(1)),e.parentNode.insertBefore(i,e),i.appendChild(e),"horizontal"===t.orientation?(i.style.position="absolute",i.style.top="0px",i.style.width="".concat(t.widthElement,"px"),t.itemActive.style.top="0px","ltr"===t.options.direction&&(t.itemActive.style.left="auto",t.itemActive.style.right="0",i.style.right="0px"),"rtl"===t.options.direction&&(t.itemActive.style.left="0",t.itemActive.style.right="auto",i.style.left="0px")):"vertical"===t.orientation&&(i.style.position="absolute",i.style.left="0px",i.style.width="100%","ttb"===t.options.direction&&(t.itemActive.style.bottom="0",t.itemActive.style.top="auto",i.style.bottom="0px"),"btt"===t.options.direction&&(t.itemActive.style.bottom="auto",t.itemActive.style.top="0",i.style.top="0px"))})}},{key:"removeImageWrappers",value:function(){var t=this;_toConsumableArray(this.options.element.querySelectorAll(this.options.selectors.item)).forEach(function(e){e.appendChild(e.querySelector("img")),e.querySelector(t.options.selectors.imageWrapper).remove(),e.removeAttribute("style")})}},{key:"addEvents",value:function(){var t=this;this.onMove=function(e){t.move(e)},this.getUserEventsToTrack().forEach(function(e){t.options.element.addEventListener(e,t.onMove,!1)}),this.onResize=function(){t.resize()},window.addEventListener("resize",this.onResize,!1)}},{key:"removeEvents",value:function(){var t=this;this.getUserEventsToTrack().forEach(function(e){t.options.element.removeEventListener(e,t.onMove)}),window.removeEventListener("resize",this.onResize)}},{key:"getUserEventsToTrack",value:function(){return this.hasTouch?this.hasMSPointer?["pointerstart","MSPointerMove"]:["touchstart","touchmove"]:["mousemove"]}},{key:"resize",value:function(){var t=this,e=0,i=null;(this.heightElement=parseInt(this.options.element.offsetHeight),this.widthElement=parseInt(this.options.element.offsetWidth),"horizontal"===this.orientation)?(_toConsumableArray(this.options.element.querySelectorAll(this.options.selectors.itemActive)).forEach(function(e){e.style.position="absolute",e.style.top="0px",e.style.width=t.widthElement}),"ltr"===this.options.direction?(e=this.itemActive.offsetLeft,i="".concat(e,"px, 0")):"rtl"===this.options.direction&&(e=-1*(this.widthElement-this.itemActive.offsetWidth),i="".concat(e,"px, 0"))):"vertical"===this.orientation&&("ttb"===this.options.direction?(e=this.itemActive.offsetTop,i="0, ".concat(e,"px")):"btt"===this.options.direction&&(e=-1*(this.heightElement-this.itemActive.offsetHeight),i="0 , ".concat(e,"px")));this.options.cursor&&(this.cursor.style.transform="translate(".concat(i,") translateZ(0)"))}},{key:"move",value:function(t){t.preventDefault(),null===this.timerGoTo||this.timerCleaned||(clearTimeout(this.timerGoTo),clearTimeout(this.timerGoToAfter),this.options.cursor&&this.updateCursor(),this.timerCleaned=!0);var e,i,o=0,s=0,r=0;e=this.hasTouch?t.touches[0].pageX:(this.hasMSPointer,t.pageX),i=this.hasTouch?t.touches[0].pageY:(this.hasMSPointer,t.pageY);var n=this.options.element.getBoundingClientRect();"ltr"===this.options.direction||"rtl"===this.options.direction?"ltr"===this.options.direction?(o=(s=parseInt(e-n.x))+"px, 0px",r=this.widthElement-s):(o=-(s=parseInt(this.widthElement-(e-n.x)))+"px, 0px",r=this.widthElement-s):"ttb"!==this.options.direction&&"btt"!==this.options.direction||("ttb"===this.options.direction?(o="0px, "+(s=parseInt(i-n.y))+"px",r=this.heightElement-s):(o="0px, "+-(s=parseInt(this.heightElement-(i-n.y)))+"px",r=this.heightElement-s)),this.options.cursor&&(this.cursor.style.transform="translate(".concat(o,") translateZ(0)")),this.itemActive.style[this.widthHeight]="".concat(r,"px"),this.position=s}},{key:"goTo",value:function(t){var e=this;this.timerGoTo=setTimeout(function(){var i=0,o=0,s=0;"ltr"===e.options.direction||"rtl"===e.options.direction?(i=e.widthElement-e.widthElement*t/100,o=e.widthElement*t/100):"ttb"!==e.options.direction&&"btt"!==e.options.direction||(i=e.heightElement-e.heightElement*t/100,o=e.heightElement*t/100),e.itemActive.style[e.widthHeight]="".concat(i,"px"),e.options.cursor&&(e.cursor.style[e.attrToAnimate]=o,"ltr"===e.options.direction?(s=i+"px, 0",e.cursor.style[e.attrToAnimate]="auto"):"rtl"===e.options.direction?(s=i+"px, 0",e.cursor.style[e.attrToAnimate]="auto"):"ttb"===e.options.direction?(s="0, "+i+"px",e.cursor.style[e.attrToAnimate]=0):"btt"===e.options.direction&&(e.cursor.style[e.attrToAnimate]="auto",s="0, "+i+"px"),e.cursor.style.transform="translate(".concat(s,") translateZ(0)")),e.position=i},100)}},{key:"reset",value:function(){this.cursor.style.transform="none","horizontal"===this.orientation?(this.itemActive.style.width="100%",this.cursor.style.left="0px"):(this.itemActive.style.height="100%",this.cursor.style.top="0px")}},{key:"destroy",value:function(){this.reset(),this.cursor.remove(),this.removeEvents(),this.removeImageWrappers()}}]),t}(),_default=BeforeAfter;exports.default=_default,module.exports=BeforeAfter;